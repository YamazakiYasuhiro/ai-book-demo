# アバターのプロンプト改善

## 応答をするアバターのプロンプト

アバターのLLMを呼び出す際には、プロンプトに以下の情報を追加してください。

- 自身のアバター名
- 同じチャットルームに参加しているアバター名一覧
    - ユーザも含まれていることを忘れず記載ください。
- 議題について(チャットルーム名)

## メッセージの管理とAPIへの渡し方

Assistant APIのメッセージは、ユーザのメッセージと、システムのメッセージに別れます。
メッセージは、ユーザとアバターのメッセージを区別しています。

少し混同しやすいので、概念を整理しておきます。
Assistant APIのメッセージは「ユーザメッセージ」と「システムメッセージ」の２種類で呼称します。
本チャットシステムのユーザが入力したメッセージは「ユーザ発言」と呼び、アバターのメッセージは「アバター発言」と呼ぶことにします。

Assistant APIに渡すメッセージは、そのアバター自身が発言した「アバター発言」を「システムメッセージ」とし、「ユーザ発言」と、**そのアバター以外の「アバター発言」**をすべて、「ユーザメッセージ」として扱い、APIへ渡してください。
つまり、LLMで生成するのは、そのアバター自身の発言であり、すなわち「システムメッセージ」を生成するということになります。
それ以外をすべて「ユーザメッセージ」として扱う必要があります。
そのため、「ユーザメッセージ」は、**自身のアバター以外のもの**が**複数混じることになる**ため、それらを区別する意味で「ユーザメッセージ」の先頭には必ず発言者の名前情報(ユーザかアバター名)を記載するようにしてください。

### ユーザメッセージ例

ユーザのメッセージの場合は以下のようにします。
```
Name: ユーザ
Message:
こんにちは
```

他のアバターの発言であれば、ユーザメッセージは以下のようにします。
```
Name: (Avatar) アバターA
Message:
こんにちは
```

「アバターA」がアバターの名前に該当します。

# アバターのメッセージ監視タイミングについて

現在は10秒固定の間隔で、新しいメッセージがあるかを確認するようになっています。
今後は、5秒から20秒のランダムの間隔にしてください。
反応の速度にムラを作ることで、より自然な応答をしているように見せることができると思います。
